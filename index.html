<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn Spanish from German with adaptive exercises and offline support">
    <meta name="theme-color" content="#20B2AA">
    <meta name="color-scheme" content="light">
    <title>Spanish Learning App</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Skip to main content for keyboard navigation -->
    <a href="#main-content" class="skip-to-main" style="position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden;">Zum Hauptinhalt springen</a>

    <!-- Sidebar Toggle -->
    <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Seitenleiste ein-/ausblenden" aria-expanded="true" aria-controls="sidebar">âœ•</button>

    <div id="app">
        <!-- Sidebar -->
        <aside id="sidebar" role="complementary" aria-label="Ãœbungsnavigation">
            <div class="sidebar-header">Ãœbungen</div>
            <nav id="exercise-nav" role="navigation" aria-label="Ãœbungsliste"></nav>
        </aside>

        <!-- Main Content -->
        <main id="main-content" role="main">
            <!-- Progress Bar -->
            <div id="progress" role="region" aria-label="Lernfortschritt">
                <span class="progress-text" id="progress-label">Laden...</span>
                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-labelledby="progress-label">
                    <div class="progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <!-- Exercise Area -->
            <div id="exercise-area" role="region" aria-live="polite" aria-atomic="true" aria-label="Ãœbungsbereich">
                <p>LÃ¤dt Ãœbungen...</p>
            </div>

            <!-- Actions -->
            <div id="actions" role="toolbar" aria-label="Ãœbungsaktionen">
                <button id="prev-btn" aria-label="Zur vorherigen Ãœbung" style="display:none;">â† ZurÃ¼ck</button>
                <button id="settings-btn" aria-label="Einstellungen Ã¶ffnen">âš™ï¸</button>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden" role="dialog" aria-modal="true" aria-labelledby="settings-title">
        <div class="modal-content" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <h2 id="settings-title">âš™ï¸ Einstellungen</h2>

            <!-- Learning Settings -->
            <fieldset style="margin-bottom: 30px; border: none; padding: 0;">
                <legend style="margin-bottom: 15px; font-size: 16px; color: var(--primary); font-weight: bold;">Lernhilfe</legend>
                <p style="margin-bottom: 15px; color: var(--text-muted); font-size: 14px;" id="help-description">
                    WÃ¤hle, wie viele Hinweise du erhalten mÃ¶chtest:
                </p>

                <div role="radiogroup" aria-labelledby="help-description">
                    <label>
                        <input type="radio" name="help" value="keine" aria-describedby="help-keine-desc">
                        <strong>Keine Hilfe</strong><br>
                        <small id="help-keine-desc">Du erhÃ¤ltst keine Hinweise. Ideal fÃ¼r Fortgeschrittene.</small>
                    </label>

                    <label>
                        <input type="radio" name="help" value="normal" checked aria-describedby="help-normal-desc">
                        <strong>Normal</strong><br>
                        <small id="help-normal-desc">Hinweise erscheinen nach 3 Fehlversuchen. Empfohlen.</small>
                    </label>

                    <label>
                        <input type="radio" name="help" value="viel" aria-describedby="help-viel-desc">
                        <strong>Viel Hilfe</strong><br>
                        <small id="help-viel-desc">Hinweise erscheinen nach dem 1. Fehlversuch. Ideal fÃ¼r AnfÃ¤nger.</small>
                    </label>
                </div>
            </fieldset>

            <!-- Data Management -->
            <section style="margin-bottom: 30px; padding-top: 20px; border-top: 2px solid var(--border);" aria-labelledby="data-management-title">
                <h3 id="data-management-title" style="margin-bottom: 15px; font-size: 16px; color: var(--primary);">Datenmanagement</h3>

                <button onclick="window.DataBackup?.exportBackup()"
                        aria-label="Lernfortschritt als JSON-Datei exportieren"
                        style="width: 100%; margin-bottom: 10px; background: var(--primary); color: white;">
                    ğŸ“¥ Daten exportieren
                </button>

                <button onclick="document.getElementById('import-file-input').click()"
                        aria-label="Lernfortschritt aus JSON-Datei importieren"
                        style="width: 100%; margin-bottom: 10px; background: var(--bg); border: 2px solid var(--border); color: var(--text);">
                    ğŸ“¤ Daten importieren
                </button>
                <input type="file" id="import-file-input" accept=".json" style="display: none;"
                       aria-label="JSON-Datei fÃ¼r Import auswÃ¤hlen"
                       onchange="window.DataBackup?.importBackup(event)">

                <button onclick="if(confirm('Alle Daten lÃ¶schen?')) window.DataBackup?.clearAllData()"
                        aria-label="Alle Lerndaten unwiderruflich lÃ¶schen"
                        style="width: 100%; background: var(--error); color: white;">
                    ğŸ—‘ï¸ Alle Daten lÃ¶schen
                </button>
            </section>

            <!-- GDPR & Privacy -->
            <section style="margin-bottom: 20px; padding-top: 20px; border-top: 2px solid var(--border);" aria-labelledby="gdpr-title">
                <h3 id="gdpr-title" style="margin-bottom: 15px; font-size: 16px; color: var(--primary);">Datenschutz (DSGVO)</h3>

                <button onclick="window.GDPR?.exerciseRightToAccess()"
                        aria-label="Gespeicherte persÃ¶nliche Daten anzeigen"
                        style="width: 100%; margin-bottom: 10px; background: var(--bg); border: 2px solid var(--border); color: var(--text);">
                    ğŸ“‹ Meine Daten anzeigen (Auskunftsrecht)
                </button>

                <button onclick="window.open('privacy-policy.html', '_blank')"
                        aria-label="DatenschutzerklÃ¤rung in neuem Fenster Ã¶ffnen"
                        style="width: 100%; margin-bottom: 10px; background: var(--bg); border: 2px solid var(--border); color: var(--text);">
                    ğŸ”’ DatenschutzerklÃ¤rung
                </button>

                <button onclick="window.GDPR?.exerciseRightToDeletion()"
                        aria-label="Alle persÃ¶nlichen Daten gemÃ¤ÃŸ DSGVO-LÃ¶schungsrecht entfernen"
                        style="width: 100%; background: var(--bg); border: 2px solid var(--border); color: var(--text);">
                    âŒ Alle Daten lÃ¶schen (LÃ¶schungsrecht)
                </button>
            </section>

            <!-- App Info -->
            <section style="margin-bottom: 20px; padding-top: 20px; border-top: 2px solid var(--border);" aria-label="Applikationsinformationen">
                <p style="font-size: 12px; color: var(--text-muted); text-align: center;">
                    Version: <span id="app-version" aria-label="Aktuelle Version">1.0.0</span><br>
                    Umgebung: <span id="app-env" aria-label="Laufzeitumgebung">production</span>
                </p>
            </section>

            <div class="modal-actions" role="group" aria-label="Modal-Aktionen">
                <button id="close-settings" aria-label="Einstellungen schlieÃŸen ohne Speichern" style="background: var(--bg-secondary); color: var(--text);">
                    SchlieÃŸen
                </button>
                <button id="save-settings" class="btn-primary" aria-label="Einstellungen speichern und schlieÃŸen" style="margin: 0;">
                    Speichern
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Load data modules first (they use window.X pattern) -->
    <script src="/js/module-structure.js"></script>
    <script src="/js/lesson1-expanded.js"></script>

    <!-- UX Enhancement Systems (non-module, global window.X pattern) -->
    <script src="/js/loading-system.js"></script>
    <script src="/js/ui-enhancements.js"></script>

    <!-- Onboarding & Help Systems -->
    <script src="/js/tooltip-system.js"></script>
    <script src="/js/help-system.js"></script>
    <script src="/js/tutorial-system.js"></script>
    <script src="/js/onboarding-system.js"></script>

    <!-- Session Summary & Windows 11 Optimizations -->
    <script src="/js/session-summary-system.js"></script>
    <script src="/js/windows11-fluent-design.js"></script>
    <script src="/js/dpi-awareness-system.js"></script>

    <!-- Main ES6 module -->
    <script type="module" src="/js/main.js"></script>
</body>
</html>
